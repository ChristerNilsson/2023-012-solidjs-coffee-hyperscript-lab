// Generated by CoffeeScript 2.5.1
var KNIGHT, QUEEN, S, click, knight, makePieces, makeQueens, makeRects, queen, queens, setKnight, setQueen, setQueens, setState, setToggle, state, toggle;

import _ from 'https://cdn.skypack.dev/lodash';

import {
  N,
  col,
  row,
  log,
  svg,
  Position,
  range,
  rect,
  text,
  signal,
  effect,
  r4r,
  div,
  g
} from '/js/utils.js';

QUEEN = '♛';

KNIGHT = '♘';

S = 40; // square size

queens = [];

[toggle, setToggle] = signal(Array(N * N).fill(false));

[state, setState] = signal(0);

[queen, setQueen] = signal(50);

[knight, setKnight] = signal(23);

[queens, setQueens] = signal([]);

makeQueens = () => { // anger de rutor som damen kan placeras på
  var c, cx, cy, dx, dy, j, k, len, len1, r, ref, ref1, ref2, res;
  cx = 7; // board center x
  cy = 7; // board center y
  res = [];
  ref = range(N);
  for (j = 0, len = ref.length; j < len; j++) {
    r = ref[j];
    ref1 = range(N);
    for (k = 0, len1 = ref1.length; k < len1; k++) {
      c = ref1[k];
      dx = Math.abs(2 * c - cx);
      dy = Math.abs(2 * r - cy);
      if ((ref2 = dx * dy) !== 3 && ref2 !== 7 && ref2 !== 9 && ref2 !== 15) {
        res.push(c + 8 * r);
      }
    }
  }
  res.sort(function(a, b) {
    return a - b;
  });
  return res;
};

setQueens(makeQueens());

click = function(index) {
  setState(1 - state());
  return log('click', state());
};

// arr = _.clone toggle() # OBS utan clone så uppfattas det inte som någon uppdatering
// _.set arr,index, not arr[index] # _.set föreslogs av CoPilot!
// setToggle arr
makeRects = () => {
  var i, j, len, ref, results;
  ref = range(N * N);
  results = [];
  for (j = 0, len = ref.length; j < len; j++) {
    i = ref[j];
    results.push(((i) => {
      var c, fill, height, r, width, x, y;
      r = row(i);
      c = col(i);
      x = S + S * c;
      y = S + S * r;
      width = S;
      height = S;
      fill = ['brown', 'black'][(r + c) % 2];
      return rect({
        x,
        y,
        width,
        height,
        fill,
        onClick: () => {
          return click(i);
        }
      });
    })(i));
  }
  return results;
};

makePieces = (pieces, PIECE) => {
  var c, j, len, piece, r, results, x, y;
  results = [];
  for (j = 0, len = pieces.length; j < len; j++) {
    piece = pieces[j];
    r = row(piece);
    c = col(piece);
    x = S * (1.5 + c);
    y = S * (1.85 + r);
    results.push(text({
      x,
      y,
      "text-anchor": "middle",
      "font-size": S,
      fill: "white",
      onClick: () => {
        return click(piece);
      }
    }, PIECE));
  }
  return results;
};

r4r(() => { // Har ej förstått varför TVÅ loopar behövs.
  return svg({
    viewBox: "0 0 400 400",
    width: 320,
    height: 320
  }, makeRects(), () => {
    if (state() === 0) {
      return makePieces(queens(), QUEEN);
    }
  }, () => {
    if (state() === 1) {
      return makePieces([queen()], QUEEN);
    }
  }, () => {
    if (state() === 1) {
      return makePieces([knight()], KNIGHT);
    }
  });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoNy5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXMiOlsiY29mZmVlXFxza2V0Y2g3LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsSUFBQSxNQUFBLEVBQUEsS0FBQSxFQUFBLENBQUEsRUFBQSxLQUFBLEVBQUEsTUFBQSxFQUFBLFVBQUEsRUFBQSxVQUFBLEVBQUEsU0FBQSxFQUFBLEtBQUEsRUFBQSxNQUFBLEVBQUEsU0FBQSxFQUFBLFFBQUEsRUFBQSxTQUFBLEVBQUEsUUFBQSxFQUFBLFNBQUEsRUFBQSxLQUFBLEVBQUE7O0FBQUEsT0FBTyxDQUFQLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLENBQVI7RUFBVSxHQUFWO0VBQWMsR0FBZDtFQUFrQixHQUFsQjtFQUFzQixHQUF0QjtFQUEwQixRQUExQjtFQUFtQyxLQUFuQztFQUF5QyxJQUF6QztFQUE4QyxJQUE5QztFQUFtRCxNQUFuRDtFQUEwRCxNQUExRDtFQUFpRSxHQUFqRTtFQUFxRSxHQUFyRTtFQUF5RSxDQUF6RTtDQUFBLE1BQUE7O0FBRUEsS0FBQSxHQUFROztBQUNSLE1BQUEsR0FBUzs7QUFFVCxDQUFBLEdBQUksR0FOSjs7QUFPQSxNQUFBLEdBQVM7O0FBRVQsQ0FBQyxNQUFELEVBQVEsU0FBUixDQUFBLEdBQXFCLE1BQUEsQ0FBTyxLQUFBLENBQU0sQ0FBQSxHQUFFLENBQVIsQ0FBVSxDQUFDLElBQVgsQ0FBZ0IsS0FBaEIsQ0FBUDs7QUFDckIsQ0FBQyxLQUFELEVBQU8sUUFBUCxDQUFBLEdBQW1CLE1BQUEsQ0FBTyxDQUFQOztBQUNuQixDQUFDLEtBQUQsRUFBTyxRQUFQLENBQUEsR0FBbUIsTUFBQSxDQUFPLEVBQVA7O0FBQ25CLENBQUMsTUFBRCxFQUFRLFNBQVIsQ0FBQSxHQUFxQixNQUFBLENBQU8sRUFBUDs7QUFDckIsQ0FBQyxNQUFELEVBQVEsU0FBUixDQUFBLEdBQXFCLE1BQUEsQ0FBTyxFQUFQOztBQUVyQixVQUFBLEdBQWEsQ0FBQSxDQUFBLEdB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ZUFBRyxLQUFBLENBQU0sS0FBTjtNQUFIO0lBQXJFLENBQUwsRUFBMkYsS0FBM0Y7RUFMRCxDQUFBOztBQURZOztBQVFiLEdBQUEsQ0FBSSxDQUFBLENBQUEsR0FBQSxFQUFBO1NBQ0gsR0FBQSxDQUFJO0lBQUMsT0FBQSxFQUFRLGFBQVQ7SUFBd0IsS0FBQSxFQUFNLEdBQTlCO0lBQW1DLE1BQUEsRUFBTztFQUExQyxDQUFKLEVBQ0MsU0FBQSxDQUFBLENBREQsRUFFQyxDQUFBLENBQUEsR0FBQTtJQUFHLElBQUcsS0FBQSxDQUFBLENBQUEsS0FBVyxDQUFkO2FBQXFCLFVBQUEsQ0FBVyxNQUFBLENBQUEsQ0FBWCxFQUFvQixLQUFwQixFQUFyQjs7RUFBSCxDQUZELEVBR0MsQ0FBQSxDQUFBLEdBQUE7SUFBRyxJQUFHLEtBQUEsQ0FBQSxDQUFBLEtBQVcsQ0FBZDthQUFxQixVQUFBLENBQVcsQ0FBQyxLQUFBLENBQUEsQ0FBRCxDQUFYLEVBQXFCLEtBQXJCLEVBQXJCOztFQUFILENBSEQsRUFJQyxDQUFBLENBQUEsR0FBQTtJQUFHLElBQUcsS0FBQSxDQUFBLENBQUEsS0FBVyxDQUFkO2FBQXFCLFVBQUEsQ0FBVyxDQUFDLE1BQUEsQ0FBQSxDQUFELENBQVgsRUFBc0IsTUFBdEIsRUFBckI7O0VBQUgsQ0FKRDtBQURHLENBQUoiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdodHRwczovL2Nkbi5za3lwYWNrLmRldi9sb2Rhc2gnXHJcbmltcG9ydCB7Tixjb2wscm93LGxvZyxzdmcsUG9zaXRpb24scmFuZ2UscmVjdCx0ZXh0LHNpZ25hbCxlZmZlY3QscjRyLGRpdixnfSBmcm9tICcvanMvdXRpbHMuanMnXHJcblxyXG5RVUVFTiA9ICfimZsnXHJcbktOSUdIVCA9ICfimZgnXHJcblxyXG5TID0gNDAgIyBzcXVhcmUgc2l6ZVxyXG5xdWVlbnMgPSBbXVxyXG5cclxuW3RvZ2dsZSxzZXRUb2dnbGVdID0gc2lnbmFsIEFycmF5KE4qTikuZmlsbCBmYWxzZVxyXG5bc3RhdGUsc2V0U3RhdGVdID0gc2lnbmFsIDBcclxuW3F1ZWVuLHNldFF1ZWVuXSA9IHNpZ25hbCA1MFxyXG5ba25pZ2h0LHNldEtuaWdodF0gPSBzaWduYWwgMjNcclxuW3F1ZWVucyxzZXRRdWVlbnNdID0gc2lnbmFsIFtdXHJcblxyXG5tYWtlUXVlZW5zID0gPT4gIyBhbmdlciBkZSBydXRvciBzb20gZGFtZW4ga2FuIHBsYWNlcmFzIHDDpVxyXG5cdGN4ID0gNyAjIGJvYXJkIGNlbnRlciB4XHJcblx0Y3kgPSA3ICMgYm9hcmQgY2VudGVyIHlcclxuXHRyZXMgPSBbXVxyXG5cdGZvciByIGluIHJhbmdlIE5cclxuXHRcdGZvciBjIGluIHJhbmdlIE5cclxuXHRcdFx0ZHggPSBNYXRoLmFicyAyKmMgLSBjeFxyXG5cdFx0XHRkeSA9IE1hdGguYWJzIDIqciAtIGN5XHJcblx0XHRcdGlmIGR4KmR5IG5vdCBpbiBbMyw3LDksMTVdIHRoZW4gcmVzLnB1c2ggYys4KnJcclxuXHRyZXMuc29ydCAoYSxiKSAtPiBhLWJcclxuXHRyZXNcclxuc2V0UXVlZW5zIG1ha2VRdWVlbnMoKVxyXG5cclxuY2xpY2sgPSAoaW5kZXgpIC0+XHJcblx0c2V0U3RhdGUgMSAtc3RhdGUoKVxyXG5cdGxvZyAnY2xpY2snLHN0YXRlKClcclxuXHQjIGFyciA9IF8uY2xvbmUgdG9nZ2xlKCkgIyBPQlMgdXRhbiBjbG9uZSBzw6UgdXBwZmF0dGFzIGRldCBpbnRlIHNvbSBuw6Vnb24gdXBwZGF0ZXJpbmdcclxuXHQjIF8uc2V0IGFycixpbmRleCwgbm90IGFycltpbmRleF0gIyBfLnNldCBmw7ZyZXNsb2dzIGF2IENvUGlsb3QhXHJcblx0IyBzZXRUb2dnbGUgYXJyXHJcblxyXG5tYWtlUmVjdHMgPSA9PlxyXG5cdGZvciBpIGluIHJhbmdlIE4qTlxyXG5cdFx0ZG8gKGkpID0+XHJcblx0XHRcdHIgPSByb3cgaVxyXG5cdFx0XHRjID0gY29sIGlcclxuXHRcdFx0eCA9IFMgKyBTKmNcclxuXHRcdFx0eSA9IFMgKyBTKnJcclxuXHRcdFx0d2lkdGggPSBTXHJcblx0XHRcdGhlaWdodCA9IFNcclxuXHRcdFx0ZmlsbCA9IFsnYnJvd24nLCdibGFjayddWyhyK2MpICUgMl1cclxuXHRcdFx0cmVjdCB7eCwgeSwgd2lkdGgsIGhlaWdodCwgZmlsbCwgb25DbGljazogPT4gY2xpY2sgaX1cclxuXHJcbm1ha2VQaWVjZXMgPSAocGllY2VzLFBJRUNFKSA9PlxyXG5cdGZvciBwaWVjZSBpbiBwaWVjZXNcclxuXHRcdHIgPSByb3cgcGllY2VcclxuXHRcdGMgPSBjb2wgcGllY2VcclxuXHRcdHggPSBTKigxLjUrYylcclxuXHRcdHkgPSBTKigxLjg1K3IpXHJcblx0XHR0ZXh0IHt4LCB5LCBcInRleHQtYW5jaG9yXCI6XCJtaWRkbGVcIiwgXCJmb250LXNpemVcIjpTLCBmaWxsOlwid2hpdGVcIiwgb25DbGljazogPT4gY2xpY2sgcGllY2V9LCBQSUVDRVxyXG5cclxucjRyID0+ICMgSGFyIGVqIGbDtnJzdMOldHQgdmFyZsO2ciBUVsOFIGxvb3BhciBiZWjDtnZzLlxyXG5cdHN2ZyB7dmlld0JveDpcIjAgMCA0MDAgNDAwXCIsIHdpZHRoOjMyMCwgaGVpZ2h0OjMyMH0sXHJcblx0XHRtYWtlUmVjdHMoKVxyXG5cdFx0PT4gaWYgc3RhdGUoKSA9PSAwIHRoZW4gbWFrZVBpZWNlcyBxdWVlbnMoKSxRVUVFTlxyXG5cdFx0PT4gaWYgc3RhdGUoKSA9PSAxIHRoZW4gbWFrZVBpZWNlcyBbcXVlZW4oKV0sUVVFRU5cclxuXHRcdD0+IGlmIHN0YXRlKCkgPT0gMSB0aGVuIG1ha2VQaWVjZXMgW2tuaWdodCgpXSxLTklHSFRcclxuIl19
//# sourceURL=c:\github\2023-012-solidjs-coffee-hyperscript-lab\coffee\sketch7.coffee